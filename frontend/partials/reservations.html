<div id="wrapper" class="reservationForm">
    <section>
        <br>
        <article>
            <h3>Beschikbaarheid kampplaats</h3>

            <div class="my-calendar">
                <span class="year">Selecteer jaar: <select ng-model="year"
                                                           ng-options="y for y in years"></select></span><br>

                <div class="calendar" my-calendar></div>
            </div>
            <br>

            <div class="legend">
                <div style="display: inline-block; width: 20px" class="free">&nbsp;</div>
                = Vrij

                <div style="display: inline-block; width: 20px" class="pending">&nbsp;</div>
                = Aangevraagd

                <div style="display: inline-block; width: 20px" class="confirmed">&nbsp;</div>
                = Bezet

                <div style="display: inline-block; width: 20px" class="closed">&nbsp;</div>
                = Gesloten
            </div>
            <br>
        </article>


        <article ng-if="is_authorized()">
            <form class="adminReservationForm" name="adminReservationForm" novalidate>
                 <input type="text" id="arrival" name="arrival" size="10" min="{{today}}" ng-model="reservation._arrival" placeholder="Aankomst" date-from with-to="departure" readonly autocomplete="off" required>
                 <input type="text" id="departure" name="departure" size="10" min="{{reservation._arrival}}" ng-model="reservation._departure" placeholder="Vertrek" date-to with-from="arrival" autocomplete="off" readonly required>

                 <input type="text" id="entity" name="entity" ng-model="reservation._entity" placeholder="Omschrijving" tabindex="1" autofocus required>

                 <button class="adminButton" ng-click="submitAdminReservationForm()"
                         ng-disabled="!adminReservationForm.$valid">{{reservation_button}}</button>

                <div class="status {{status}}">{{message}}</div>
            </form>

            <div ng-if="current_reservation">
                <br>
                <h3>Geselecteerde reservatie</h3>

                <div class="reservation {{ current_reservation._status }} {{ reservation_class(current_reservation) }}">
                    <span class="delete">
                        <a href="" class="remove" ng-click="deleteReservation(current_reservation._id)">Verwijder deze reservatie</a>
                    </span> 

                    <div class="entity">
                        <span ng-if="reservation_expired(current_reservation)"><img src="/img/alert.png" alt="expired"></span>
                        {{current_reservation._entity}} ({{current_reservation._name}})
                    </div>
                    <div>Aantal personen: <input  type="number" ng-model="current_reservation._nr_of_people" ng-change="updateReservation(current_reservation)"></div>
                    <div>Aangevraagd op: <input type="text" size="20" ng-model="current_reservation._created" disabled></div>
                    <div>Van: <input type="text" size="10" ng-model="current_reservation._arrival" datepicker autocomplete="off" readonly ng-change="updateReservation(reservation)"></div>
                    <div>Tot: <input type="text" size="10" ng-model="current_reservation._departure" datepicker autocomplete="off" readonly ng-change="updateReservation(reservation)"></div>
                    <div class="status">Status: <select ng-model="current_reservation._status"
                                                        ng-options="s for s in reservation_status"
                                                        ng-change="updateReservation(current_reservation)"></select></div>

                    <span class="contact">
                        <div>Naam: {{current_reservation._name}}</div>
                        <div>Email: <a href="mailto:{{current_reservation._email}}?subject=Kampplaats 't Stupke">{{current_reservation._email}}</a></div>
                        <div>Telefoon: {{current_reservation._phone}}</div>
                    </span>
                </div>
            </div>
        </article>


        <article ng-if="!is_authorized()">
            <h3>Reservatieformulier</h3>

            <div>
                <div id="image">
                    <img class="photo" src="http://placehold.it/250x180" alt="kampplaats">
                </div>

                <form name="reservationForm" novalidate>
                    <label for="type">Soort</label>
                    <select id="type"
                            ng-model="reservation._type"
                            ng-options="t for t in reservation_types"
                            ng-change="set_limits(reservation)"
                            ></select><br>

                    <label for="entity">Vereniging</label>
                    <input type="text" id="entity" name="entity" ng-model="reservation._entity" placeholder="Naam van vereniging" autocomplete="off" required>
                    <span class="validation-error" ng-show="reservationForm.entity.$error.required">Verplicht!</span>
                    <br>

                    <label for="nr_of_people">Aantal personen</label>
                    <input id="nr_of_people" name="nr_of_people" type="number" min="{{min_nr_of_people}}" max="{{max_nr_of_people}}"
                           ng-model="reservation._nr_of_people" autocomplete="off"
                           required>
                    <span class="validation-error"
                          ng-show="reservationForm.nr_of_people.$error.min">Minstens {{min_nr_of_people}} personen</span>
                    <span class="validation-error"
                          ng-show="reservationForm.nr_of_people.$error.max">Maximaal {{max_nr_of_people}} personen</span>
                    <br>

                    <label for="name">Naam</label>
                    <input id="name" name="name" ng-model="reservation._name" placeholder="Naam" autocomplete="off" required>
                    <span class="validation-error" ng-show="reservationForm.name.$error.required">Verplicht!</span>
                    <br>

                    <label for="address">Adres</label>
                    <input id="address" name="address" ng-model="reservation._address" placeholder="Adres" autocomplete="off" required>
                    <span class="validation-error" ng-show="reservationForm.address.$error.required">Verplicht!</span>
                    <br>

                    <label for="email">Email</label>
                    <input id="email" name="email" type="email" ng-model="reservation._email" autocomplete="off" placeholder="Email" required>
                    <span class="validation-error" ng-show="reservationForm.email.$error.email">Ongeldige email</span>
                    <span class="validation-error" ng-show="reservationForm.email.$error.required">Verplicht!</span>
                    <br>

                    <label for="phone">Telefoon/GSM</label>
                    <input id="phone" name="phone" ng-model="reservation._phone" placeholder="Telefoon/GSM" autocomplete="off" required>
                    <span class="validation-error" ng-show="reservationForm.phone.$error.required">Verplicht!</span>
                    <br>

                    <!-- VAN -->
                    <label for="arrival">Aankomst</label>
                    <input type="text" id="arrival" name="arrival" size="10" min="{{today}}" ng-model="reservation._arrival"
                           placeholder="Aankomst" date-from with-to="departure" readonly autocomplete="off" required>
                    <span class="validation-error" ng-show="reservationForm.arrival.$error.required">Verplicht!</span>
                    <br>

                    <!-- TOT -->
                    <label for="departure">Vertrek</label>
                    <input type="text" id="departure" name="departure" size="10" min="{{reservation._arrival}}"
                           ng-model="reservation._departure" placeholder="Vertrek" date-to with-from="arrival" autocomplete="off" readonly
                           required>
                    <span class="validation-error" ng-show="reservationForm.departure.$error.required">Verplicht!</span>
                    <br>

                    <br><br>
                    <textarea ng-model="reservation._remarks" placeholder="Eventuele opmerkingen"/><br><br>


                    <input type="checkbox" ng-model="reservation._agreed"/><span class="agree">Ik ga akkoord met het <a
                        href="http://www.tstupke.be/Teksten/Huishoudelijk%20Reglement%20Kampplaats%20%27t%20Stupke.pdf" target="_blank">reglement</a></span><br><br><br>

                    <div class="price" ng-show="reservation._type == 'weekend'">Geschatte prijs (exclusief kosten): 250 &euro;</div>
                    <div class="price" ng-show="reservation._type != 'weekend'">Geschatte prijs (exclusief kosten): {{(reservation._nr_of_people * 3.25 * numberOfDays(reservation._arrival, reservation._departure)) | number:0}} &euro;</div>
                    <br><br>

                    <button ng-click="already_sending || submitReservationForm()"
                            ng-disabled="(!reservation._agreed || !reservationForm.$valid)">{{reservation_button}}
                    </button>
                </form>
            </div>
        </article>

        <span ng-if="is_authorized()">
            <!--<p>-->

            <!--<div class="debug">{{reservation | json}}</div>-->
            <!--</p>-->


            <br>
            <article>
                <h3>Reservaties voor {{year}}</h3>

                <div class="reservation {{ reservation._status }} {{ reservation_class(reservation) }}" ng-repeat="reservation in reservations">
                    <span class="delete">
                        <a href="" class="remove" ng-click="deleteReservation(reservation._id)">Verwijder deze reservatie</a>
                    </span> 


                    <div class="entity">
                        <span ng-if="reservation_expired(reservation)"><img src="/img/alert.png" alt="expired"></span>
                        {{reservation._entity}} ({{reservation._name}})
                    </div>
                    <div>Aantal personen: <input  type="number" ng-model="reservation._nr_of_people" ng-change="updateReservation(reservation)"></div>
                    <div>Aangevraagd op: <input type="text" size="20" ng-model="reservation._created" disabled></div>
                    <div>Van: <input type="text" size="10" ng-model="reservation._arrival" datepicker autocomplete="off" readonly ng-change="updateReservation(reservation)"></div>
                    <div>Tot: <input type="text" size="10" ng-model="reservation._departure" datepicker autocomplete="off" readonly ng-change="updateReservation(reservation)"></div>
                    <div class="status">Status: <select ng-model="reservation._status"
                                                        ng-options="s for s in reservation_status"
                                                        ng-change="updateReservation(reservation)"></select></div>

                    <span class="contact">
                        <div>Naam: {{reservation._name}}</div>
                        <div>Email: <a href="mailto:{{reservation._email}}?subject=Kampplaats 't Stupke">{{reservation._email}}</a></div>
                        <div>Telefoon: {{reservation._phone}}</div>
                    </span>

                </div>
            </article>
        </span>

</section>
</div>